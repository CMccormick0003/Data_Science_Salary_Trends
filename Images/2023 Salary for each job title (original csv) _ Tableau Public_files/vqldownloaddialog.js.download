/*! BEGIN DownloadDialog */

(function(){'dont use strict';var a={};global.tab=global.tab||{};ss.initAssembly(a,'vqldownloaddialog');var b=global.tab.DownloadDialogComponent=ss.mkType(a,'tab.DownloadDialogComponent',function(e){this.$8=tab.Strings.ToolbarDisabledPdfPptImageDownloadExplanation;spiff.PureRenderComponent.call(this,e);},{$3:function(){return {buttonType:b.$2,handleClick:this.props.pdfButtonClicked,testId:'DownloadPdf',children:tab.Strings.ToolbarPrintToPdf,disabled:this.props.pdfButtonDisabled,title:(this.props.pdfButtonDisabled?this.$8:null),style:b.$1};},$4:function(){return {buttonType:b.$2,handleClick:this.props.powerPointButtonClicked,testId:'DownloadPowerPoint',children:tab.Strings.ToolbarExportPowerPoint,disabled:this.props.powerPointButtonDisabled,title:(this.props.powerPointButtonDisabled?this.$8:null),style:b.$1};},$2:function(){return {buttonType:b.$2,handleClick:this.props.imageButtonClicked,testId:'DownloadImage',children:tab.Strings.ToolbarExportImage,disabled:this.props.imageButtonDisabled,title:(this.props.imageButtonDisabled?this.$8:null),style:b.$1};},$1:function(){var e=(new tab.DownloadButtonEnablementLogicOperator()).withPermissionCriterion(!this.props.dataButtonDisabled).withPermissionCriterionMessage(tab.Strings.ToolbarDisabledDataDownloadExplanation).withSheetSelectionCriterion(this.props.sheetSelected).withSheetSelectionCriterionMessage(tab.Strings.ToolbarDisabledDownloadExplanation);return {buttonType:b.$2,handleClick:this.props.dataButtonClicked,testId:'DownloadData',children:tab.Strings.ToolbarExportData,disabled:!e.evaluateResult(),title:e.evaluateMessage(),style:b.$1};},$0:function(){return {buttonType:b.$2,handleClick:this.props.crosstabButtonClicked,testId:'DownloadCrosstab',children:tab.Strings.ToolbarExportCrosstab,disabled:this.props.crosstabButtonDisabled,title:(this.props.crosstabButtonDisabled?tab.Strings.ToolbarDisabledCrosstabDownloadExplanation:null),style:b.$1};},$5:function(){return {buttonType:b.$2,handleClick:this.props.workbookButtonClicked,testId:'DownloadWorkbook',children:tab.Strings.ToolbarWorkbook,disabled:this.props.workbookButtonDisabled,title:(this.props.workbookButtonDisabled?tab.Strings.ToolbarDisabledWorkbookDownloadExplanation:null),style:b.$1};},$6:function(){var e={className:'tab-downloadApp',href:this.props.downloadAppUrl,style:b.$3,target:'_blank',testId:'DownloadGetApp',children:tab.Strings.ToolbarPublicDownloadLabelWeb};return React.createElement(SharedWidgets.TextLinkWidget,e);},$7:function(){var e=document.createElement('div');var f={testId:'IncompatibleBrowserToast',toastType:'error',message:tab.Strings.ToolbarBrowserNotSupportedDownloadExplanation,onCloseRequest:function(){},zIndex:1500};var g=React.createElement(SharedWidgets.ToastWidget,f);ReactDOM.render(g,e);},componentDidMount:function(){if(this.props.shouldShowIncompatibleBrowserToast){this.$7();}},render:function(){return spiff.DOMElements.div({className:'tab-downloadDialog','data-tb-test-id':'download-dialog-contents'},spiff.DOMElements.fieldset({style:b.$4},spiff.DOMElements.legend({className:'tab-downloadLabel',style:b.$5},tab.Strings.ToolbarDownloadSelectFormat),React.createElement(SharedWidgets.ButtonWidget,this.$2()),React.createElement(SharedWidgets.ButtonWidget,this.$1()),React.createElement(SharedWidgets.ButtonWidget,this.$0()),React.createElement(SharedWidgets.ButtonWidget,this.$3()),React.createElement(SharedWidgets.ButtonWidget,this.$4()),(this.props.shouldShowDownloadWorkbook?ss.mkdel(this,function(){return React.createElement(SharedWidgets.ButtonWidget,this.$5());})():null)),(this.props.shouldShowAppButton?ss.mkdel(this,function(){return this.$6();})():null));}});var c=global.tab.DownloadDialogFactory=ss.mkType(a,'tab.DownloadDialogFactory',function(){},{buildDialogContent:function(e){return new d(e);}});var d=global.tab.DownloadDialogViewModel=ss.mkType(a,'tab.DownloadDialogViewModel',function(e){this.callOnClose=null;this.$3$1=null;ss.makeGenericType(spiff.BaseReactViewModel$1,[Object]).call(this);this.callOnClose=e;},{add_hideDialogRequested:function(e){this.$3$1=ss.delegateCombine(this.$3$1,e);},remove_hideDialogRequested:function(e){this.$3$1=ss.delegateRemove(this.$3$1,e);},get_viewModel:function(){return this;},$a:function(){return !tsConfig.is_mobile&&(!tsConfig.previewMode&&!ss.isNullOrEmptyString(tsConfig.downloadURI)||tsConfig.is_metrics_view);},get_exportHelper:function(){return new tab.ExportHelper();},$3:function(){if(tab.FeatureFlags.isEnabled('DownloadAsVersionHiFi')){var e=tab.CommandUtils.newCommand({ns:'tabdoc',cmd:'download-as-version-hi-fi'},null);e.commandParams={};tab.CommandController.SendCommand(tab.ClientCommand.createRemoteOnly(e,'immediately',null,null));}else{tab.ModuleManager.load$1(tab.IDownloadAsVersionDialogModule).call(null,[]).done(ss.mkdel(this,function(f){f.showDownloadAsVersionDialog(this.callOnClose);}));}this.$9();},$6:function(){var e=this.get_exportHelper();e.setSheetScrollPositions(tab.Application.get_instance().get_client().get_viewControllers());tab.ToolbarServerCommands.exportImage(e);this.onDialogClosed();},$5:function(){tab.ToolbarServerCommands.exportData(null);this.onDialogClosed();},$4:function(){tab.ExportServerCommands.exportCrosstabOptionsDialog();this.onDialogClosed();},$7:function(){tab.ExportServerCommands.exportPdfOptionsDialog();this.$9();},$8:function(){tab.ExportServerCommands.exportPowerPoint();this.$9();},createInitialProps:function(){return {dialogWidth:260,isGlassTransparent:false,isModal:true,onCloseRequest:ss.mkdel(this,this.onDialogClosed),positioningBehavior:0,shouldAdjustPositionOnWindowResize:!tsConfig.is_mobile,shouldRecenterOnUpdate:true,showCloseButton:true,showFooter:false,testId:'DownloadDialog',title:tab.Strings.ToolbarDownload,type:0,zIndex:1000};},createUpdatedProps:function(){return {children:React.createElement(b,this.buildDownloadDialogProps())};},buildDownloadDialogProps:function(){var e=BrowserSupport.BrowserSupport.IsIE()&&!BrowserSupport.BrowserSupport.IsLegacyEdge()&&tsConfig.isPublic;return {pdfButtonClicked:ss.mkdel(this,function(){this.$7();}),powerPointButtonClicked:ss.mkdel(this,function(){this.$8();}),imageButtonClicked:ss.mkdel(this,function(){this.$6();}),dataButtonClicked:ss.mkdel(this,function(){this.$5();}),crosstabButtonClicked:ss.mkdel(this,function(){this.$4();}),workbookButtonClicked:ss.mkdel(this,function(){this.$3();}),downloadAppUrl:d.$0(),shouldShowIncompatibleBrowserToast:e,shouldShowAppButton:tsConfig.isPublic&&!tsConfig.is_mobile,shouldShowDownloadWorkbook:!tsConfig.is_mobile,sheetSelected:(new tab.TransientDashboardStateReader()).isSheetSelected(),pdfButtonDisabled:e||!tsConfig.allow_export_image,powerPointButtonDisabled:e||!tsConfig.allow_export_image,imageButtonDisabled:e||!tsConfig.allow_export_image,dataButtonDisabled:!tsConfig.allow_export_data,crosstabButtonDisabled:e||!tsConfig.allow_export_data,workbookButtonDisabled:e||!this.$a()};},onDialogClosed:function(){this.$9();if(!ss.staticEquals(this.callOnClose,null)){this.callOnClose();}},onDialogHidden:function(){_.defer(ss.mkdel(this,this.dispose));},$9:function(){this.raiseActionEvent(this.$3$1);}},{$0:function(){var e=(ss.isValue(tabBootstrap.ViewerBootstrap.get_instance().location)?tabBootstrap.ViewerBootstrap.get_instance().location.toString():'');return 'http://public.tableau.com/s/download'+'?source=viz_toolbar&ref='+e.split('?')[0];}});ss.initClass(b,spiff.PureRenderComponent);ss.initClass(c,null,[tab.IDownloadDialogModule]);ss.initClass(d,ss.makeGenericType(spiff.BaseReactViewModel$1,[Object]),[tab.IViewModel,ss.IDisposable,spiff.IDialogContent,ss.makeGenericType(spiff.IPropsProvider$1,[Object])]);(function(){b.downloadDialogContentTestId='download-dialog-contents';b.$2=3;b.$4={border:'0px',margin:'0px',padding:'0px'};b.$5={padding:'0px'};b.$1={display:'block',marginTop:8,width:'100%'};b.$3={display:'block',marginTop:SharedWidgets.TabStyles.Spacing.MediumSpace,textAlign:'center'};})();(function(){d.downloadAppBaseUrl='http://public.tableau.com/s/download';})();})();// END DownloadDialog
